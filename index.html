<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gh√©p ·∫¢nh Game - 52hzmisfit</title>
  <style>
    body {
      height: 100%;
      font-family: 'Poppins', sans-serif;
      background-color: #0a0a0a;
      background: linear-gradient(180deg, #0a0a0a, #1b1208, #2a1c0b);
      color: #2377B7;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    header {
      text-align: center;
      padding: 20px;
      background: rgba(0, 0, 0, 0.4);
      box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
    }

    header a {
      margin: 0 10px;
      text-decoration: none;
      color: #ffd700;
      font-size: 20px;
      transition: 0.3s;
    }

    header a:hover {
      color: #fff;
    }

    h2 {
      margin-left: 16px;
      margin-top: 30px;
      color: #ffcc33;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .gallery {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      gap: 12px;
      padding: 16px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
    }

    .card {
      position: relative;
      flex: 0 0 auto;
      border-radius: 16px;
      overflow: hidden;
      scroll-snap-align: start;
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.6);
      transition: transform 0.3s ease;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.2));
      padding-bottom: 8px;
    }

    .card:hover {
      transform: scale(1.03);
      box-shadow: none;
    }

    .card img {
      width: 100%;
      height: auto;
      display: block;
    }

    .overlay {
      position: absolute;
      left: 0;
      padding: 6px 10px;
      background: rgba(255, 215, 0, 0.7);
      color: #000;
      border-radius: 0 8px 8px 0;
      font-size: 14px;
      font-weight: 600;
    }

    .overlay.top { top: 0; }
    .overlay.bottom { bottom: 0; border-radius: 0 8px 0 0; }

    .vertical img {
      width: 220px;
      height: 390px;
      object-fit: cover;
    }

    .horizontal img {
      width: 350px;
      height: 200px;
      object-fit: cover;
    }

    ::-webkit-scrollbar { display: none; }

    /* Auth & Cart styles */
    #auth { text-align:center; margin:20px; }
    #auth input { padding:8px; margin:6px; border-radius:6px; border:1px solid #333; }
    #auth button { padding:8px 12px; margin:6px; border-radius:6px; cursor:pointer; }

    #cart { color:white; padding:20px; background: rgba(0,0,0,0.35); margin:20px; border-radius:10px; }
    #cartList { list-style:none; padding-left:0; }
    #cartList li { margin:6px 0; }
  </style>
</head>

<body>
  <header>
    <a href="https://www.facebook.com/share/19eGihbGfm/?mibextid=wwXIfr" target="_blank">Facebook</a>
    <a href="https://www.tiktok.com/@52hzmisfit?_t=ZS-90KVyBJ9xH0&_r=1" target="_blank">TikTok</a>
    <a href="#">Zalo: 034 751 0287</a>
  </header>

  <h1 style="color:#FFC900; text-align:center;">GH√âP ·∫¢NH GAME</h1>

  <!-- Auth -->
  <div id="auth">
    <h2 style="color:#fff;">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</h2>
    <input type="email" id="emailInput" placeholder="Email">
    <input type="password" id="passwordInput" placeholder="M·∫≠t kh·∫©u">
    <br>
    <button id="registerBtn">ƒêƒÉng k√Ω</button>
    <button id="loginBtn">ƒêƒÉng nh·∫≠p</button>
    <button id="logoutBtn" style="display:none;">ƒêƒÉng xu·∫•t</button>
    <p id="userInfo" style="color: #ffd700;"></p>
  </div>

  <div id="sale-banner" style="background:#ff5252;color:#fff;text-align:center;padding:10px 0;font-size:18px;font-weight:bold;">
    ‚ö° Gi·∫£m gi√° k·∫øt th√∫c sau: <span id="countdown"></span> ‚ö°
  </div>

  <p style="margin-left:20px; line-height:1.6; color:#fff;">
    - Ch√†o b·∫°n, m√¨nh nh·∫≠n gh√©p t·∫•t c·∫£ c√°c ·∫£nh b√™n d∆∞·ªõi v√† c√≥ nh·∫≠n gh√©p theo y√™u c·∫ßu.<br>
    - ·∫¢nh s·∫Ω ƒë∆∞·ª£c tr·∫£ trong 24h, th∆∞·ªùng th√¨ s·∫Ω s·ªõm h∆°n.<br>
    - ƒê·∫∑c bi·ªát ·∫£nh tr·∫£ si√™u n√©t nha, kh√¥ng n√©t kh√¥ng l·∫•y ti·ªÅn.<br>
    - C·ª© ib Zalo <b>0347510287</b> rep cho nhanh nha.<br><br>
    <span style="color:#CE1414;">L∆∞u √Ω: chuy·ªÉn kho·∫£n tr∆∞·ªõc l√†m sau nha. N·∫øu des x·∫•u kh√¥ng ∆∞ng th√¨ ho√†n l·∫°i ti·ªÅn.</span>
  </p>

  <h1 style="color:#fff; text-align:center;">LI√äN QU√ÇN MOBILE</h1>

  <!-- Gallery & dynamic content will be injected here -->

  <!-- Cart UI -->
  <div id="cart">
    <h2>üõçÔ∏è Gi·ªè h√†ng</h2>
    <ul id="cartList"></ul>
    <h3>T·ªïng: <span id="cartTotal">0</span>ƒë</h3>
    <button id="checkoutBtn">Thanh to√°n qua Momo</button>
  </div>

  <script>
    // ‚úÖ Bi·∫øn sale to√†n c·ª•c
    let enableSale = localStorage.getItem("saleOff") === "true" ? false : true;
    const discountPercent = 20;
    const momoNumber = "0347713245"; // S·ªë Momo b·∫°n cung c·∫•p

    const sections = [
      {
        title: "X·ª© s·ªü ho√†ng h√¥n",
        class: "vertical",
        items: [
          ["xhh01.JPEG", 20000], ["xhh02.JPEG", 20000], ["xhh03.JPEG", 18000],
          ["xhh04.PNG", 19000], ["xhh05.JPEG", 20000], ["xhh06.JPEG", 25000],
          ["xhh07.JPEG", 22000], ["xhh08.JPG", 20000], ["xhh09.JPG", 20000],
          ["xhh010.JPG", 20000], ["xhh11.jpg", 20000], ["xhh12.jpg", 20000],
          ["xhh13.jpg", 20000], ["xhh14.jpg", 20000], ["xhh15.jpg", 20000],
          ["xhh16.jpg", 20000], ["xhh17.jpg", 20000], ["xhh18.jpg", 20000],
          ["xhh19.jpg", 25000], ["xhh20.jpg", 20000], ["xhh21.jpg", 20000],
          ["xhh22.jpg", 20000], ["xhh23.jpg", 20000], ["xhh24.jpg", 20000],
          ["xhh25.jpg", 20000], ["xhh26.jpg", 20000], ["xhh27.jpg", 20000],
          ["xhh28.jpg", 20000], ["xhh29.jpg", 20000], ["xhh30.jpg", 20000],
          ["xhh32.jpg", 20000], ["xhh33.jpg", 20000], ["xhh34.jpg", 20000],
          ["xhh35.jpg", 20000]
        ]
      },
      {
        title: "X·ª© s·ªü b√¨nh minh",
        class: "horizontal",
        items: [
          ["xbm01.JPEG", 20000], ["xbm02.JPEG", 19000], ["xbm03.JPEG", 20000],
          ["xbm04.JPEG", 18000], ["xbm12.JPEG", 20000], ["xbm14.JPEG", 20000],
          ["xbm07.JPEG", 14000], ["xbm08.JPEG", 16000], ["xbm10.JPEG", 18000],
          ["xbm15.JPEG", 14000], ["xbm17.JPEG", 20000], ["xbm18.JPEG", 20000],
          ["xbm19.JPEG", 22000], ["xbm20.JPEG", 18000], ["xbm21.JPEG", 22000],
          ["xbm24.jpg", 16000], ["xbm25.jpg", 12000], ["xbm26.jpg", 20000]
        ]
      },
      {
        title: "X·ª© s·ªü pha l√™",
        class: "horizontal",
        items: [
          ["xbm05.JPEG", 25000], ["xbm06.PNG", 20000], ["xbm09.JPG", 25000],
          ["xbm11.JPEG", 20000], ["xbm13.JPEG", 20000], ["xbm16.JPEG", 25000],
          ["xbm22.JPEG", 35000], ["xbm23.jpg", 20000]
        ]
      },
      {
        title: "C·ª© nh·∫Øn zalo: 0347510287 m√¨nh nha",
      }
    ];

    document.addEventListener("DOMContentLoaded", () => {
      const body = document.body;
      sections.forEach(sec => {
        const title = document.createElement("h2");
        title.textContent = sec.title;
        body.appendChild(title);

        if (!sec.items) return;

        const div = document.createElement("div");
        div.className = `gallery ${sec.class}`;
        body.appendChild(div);

        sec.items.forEach(([img, price], i) => {
          const card = document.createElement("div");
          card.className = "card";

          let finalPrice = price;
          if (enableSale) {
            finalPrice = Math.ceil(price * (1 - discountPercent / 100) / 1000) * 1000;
          }

          const priceDisplay = enableSale
            ? `<div class="overlay bottom">
                <s style="color:#a00;">${price.toLocaleString()}ƒë</s>
                <span style="color:#000; font-weight:700;"> ${finalPrice.toLocaleString()}ƒë</span>
              </div>`
            : `<div class="overlay bottom">Gi√°: ${price.toLocaleString()}ƒë</div>`;

          card.innerHTML = `
            <img src="images/${img}" alt="${sec.title} ${i+1}">
            <div class="overlay top">${img.split('.')[0].toUpperCase()}</div>
            ${priceDisplay}
            <div style="padding:8px; display:flex; justify-content:center; gap:8px;">
              <button onclick="addToCart('${img}', ${finalPrice})">üõí Th√™m v√†o gi·ªè</button>
              <button onclick="buyNow('${img}', ${finalPrice})">üí∏ Mua ngay</button>
            </div>
          `;
          div.appendChild(card);
        });
      });

      renderCart();
    });

    // H√†m c·∫≠p nh·∫≠t l·∫°i gi√° khi sale k·∫øt th√∫c
    function updatePrices() {
      document.querySelectorAll(".card").forEach(card => {
        const bottomOverlay = card.querySelector(".overlay.bottom");
        if (!bottomOverlay) return;

        const text = bottomOverlay.innerHTML;
        const match = text.match(/(\d{1,3}(?:,\d{3})*)ƒë/);
        if (!match) return;

        const originalPrice = parseInt(match[1].replace(/,/g, ""));
        bottomOverlay.innerHTML = `Gi√°: ${originalPrice.toLocaleString()}ƒë`;
      });
    }

    // Countdown sale
    const saleEndTime = new Date("2025-10-08T22:08:00+07:00").getTime();
    function updateCountdown() {
      const now = new Date().getTime();
      const distance = saleEndTime - now;

      if (distance < 0) {
        clearInterval(timer);
        document.getElementById("countdown").innerHTML = "H·∫øt th·ªùi gian gi·∫£m gi√°!";
        setTimeout(() => { const banner = document.getElementById("sale-banner"); if (banner) banner.style.display = "none"; }, 3000);
        enableSale = false;
        updatePrices();
        return;
      }

      const hours = Math.floor(distance / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      document.getElementById("countdown").innerHTML = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    }
    const timer = setInterval(updateCountdown, 1000);
    updateCountdown();

    /* ==================== Gi·ªè h√†ng (localStorage) ==================== */
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    function addToCart(name, price) {
      cart.push({ name, price });
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
      alert('ƒê√£ th√™m v√†o gi·ªè!');
    }

    function buyNow(name, price) {
      cart = [{ name, price }];
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
      checkout();
    }

    function renderCart() {
      const list = document.getElementById("cartList");
      list.innerHTML = "";
      let total = 0;
      cart.forEach((item, i) => {
        total += item.price;
        list.innerHTML += `<li>${item.name} - ${item.price.toLocaleString()}ƒë <button onclick="removeItem(${i})">‚ùå</button></li>`;
      });
      document.getElementById("cartTotal").textContent = total.toLocaleString();
    }

    function removeItem(i) {
      cart.splice(i, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    /* ========== Thanh to√°n Momo (deep link) & l∆∞u ƒë∆°n h√†ng v√†o Firestore ========== */
    document.getElementById('checkoutBtn').addEventListener('click', checkout);

    async function checkout() {
      if (cart.length === 0) return alert("Gi·ªè h√†ng tr·ªëng!");
      const total = cart.reduce((sum, it) => sum + it.price, 0);

      // L∆∞u ƒë∆°n h√†ng v√†o Firestore (n·∫øu firebase ƒë√£ ƒë∆∞·ª£c c·∫•u h√¨nh)
      try {
        if (window.db && window.auth) {
          const userEmail = window.auth.currentUser ? window.auth.currentUser.email : 'guest';
          await window.addOrder({ user: userEmail, items: cart, total, createdAt: new Date().toISOString() });
        }
      } catch (e) {
        console.warn('L∆∞u ƒë∆°n h√†ng th·∫•t b·∫°i (Firestore ch∆∞a c·∫•u h√¨nh?):', e);
      }

      // T·∫°o deep link Momo (chuy·ªÉn sang app Momo n·∫øu c√≥)
      const momoUrl = `momo://app?action=payWithApp&amount=${total}&description=GhepAnh52HzMisfit&receiver=${momoNumber}`;
      // Fallback: n·∫øu kh√¥ng m·ªü ƒë∆∞·ª£c momo schema, m·ªü trang web Momo (n·∫øu mu·ªën) ‚Äî ·ªü ƒë√¢y ta th·ª≠ m·ªü schema
      window.location.href = momoUrl;
    }

    /* ================== Firebase (Auth + Firestore) ================== */
    // File d√πng module imports; b·∫°n c·∫ßn d√°n Firebase config v√†o ph·∫ßn firebaseConfig d∆∞·ªõi ƒë√¢y
  </script>

  <!-- Firebase SDK (module) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

    // ======= D√°n firebaseConfig c·ªßa b·∫°n v√†o object d∆∞·ªõi =======
	  // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyD7EO95EH-G2w09vHIyEpy4ZGZnJ-cvVPU",
  authDomain: "ghep-anh-52hzmisfit.firebaseapp.com",
  projectId: "ghep-anh-52hzmisfit",
  storageBucket: "ghep-anh-52hzmisfit.firebasestorage.app",
  messagingSenderId: "582572533559",
  appId: "1:582572533559:web:71623c50f79bc81d841cb2",
  measurementId: "G-S6EFDXY85Y"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
    const firebaseConfig = {
      // apiKey: "...",
      // authDomain: "...",
      // projectId: "...",
      // storageBucket: "...",
      // messagingSenderId: "...",
      // appId: "..."
    };
    // ==========================================================

    // N·∫øu b·∫°n ch∆∞a d√°n config, ƒëo·∫°n d∆∞·ªõi s·∫Ω kh√¥ng kh·ªüi t·∫°o firebase
    let app, auth, db;
    try {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);
      window.auth = auth; // expose for other scripts
      window.db = db;
    } catch (e) {
      console.warn('Firebase ch∆∞a ƒë∆∞·ª£c c·∫•u h√¨nh ho·∫∑c kh·ªüi t·∫°o th·∫•t b·∫°i:', e);
    }

    // H√†m l∆∞u ƒë∆°n h√†ng (ƒë∆∞·ª£c g·ªçi t·ª´ checkout ph√≠a tr√™n)
    window.addOrder = async function(order) {
      if (!db) throw new Error('Firestore ch∆∞a kh·ªüi t·∫°o');
      await addDoc(collection(db, 'orders'), order);
    }

    // Auth handlers
    const emailInput = document.getElementById('emailInput');
    const passwordInput = document.getElementById('passwordInput');
    const registerBtn = document.getElementById('registerBtn');
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const userInfo = document.getElementById('userInfo');

    registerBtn.addEventListener('click', async () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();
      if (!email || !password) return alert('Vui l√≤ng nh·∫≠p email v√† m·∫≠t kh·∫©u');
      try {
        await createUserWithEmailAndPassword(auth, email, password);
        alert('ƒêƒÉng k√Ω th√†nh c√¥ng!');
      } catch (e) {
        alert('L·ªói ƒëƒÉng k√Ω: ' + e.message);
      }
    });

    loginBtn.addEventListener('click', async () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();
      if (!email || !password) return alert('Vui l√≤ng nh·∫≠p email v√† m·∫≠t kh·∫©u');
      try {
        await signInWithEmailAndPassword(auth, email, password);
        alert('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!');
      } catch (e) {
        alert('ƒêƒÉng nh·∫≠p th·∫•t b·∫°i: ' + e.message);
      }
    });

    logoutBtn.addEventListener('click', async () => {
      try {
        await signOut(auth);
      } catch (e) { console.warn(e); }
    });

    onAuthStateChanged(auth, (user) => {
      if (user) {
        logoutBtn.style.display = 'inline-block';
        userInfo.textContent = 'Xin ch√†o: ' + user.email;
      } else {
        logoutBtn.style.display = 'none';
        userInfo.textContent = '';
      }
    });
  </script>
</body>
</html>
